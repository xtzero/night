(function(t){function e(e){for(var a,s,o=e[0],c=e[1],l=e[2],d=0,u=[];d<o.length;d++)s=o[d],i[s]&&u.push(i[s][0]),i[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);m&&m(e);while(u.length)u.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var o=n[s];0!==i[o]&&(a=!1)}a&&(r.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},s={app:0},i={app:0},r=[];function o(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-04190fae":"409271ec","chunk-45775c53":"aaa8ec39","chunk-f73e891c":"e0a46384"}[t]+".js"}function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-04190fae":1,"chunk-45775c53":1,"chunk-f73e891c":1};s[t]?e.push(s[t]):0!==s[t]&&n[t]&&e.push(s[t]=new Promise(function(e,n){for(var a="css/"+({}[t]||t)+"."+{"chunk-04190fae":"71dadf58","chunk-45775c53":"27d594df","chunk-f73e891c":"d5c318e8"}[t]+".css",i=c.p+a,r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var l=r[o],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===a||d===i))return e()}var u=document.getElementsByTagName("style");for(o=0;o<u.length;o++){l=u[o],d=l.getAttribute("data-href");if(d===a||d===i)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var a=e&&e.target&&e.target.src||i,r=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete s[t],m.parentNode.removeChild(m),n(r)},m.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(m)}).then(function(){s[t]=0}));var a=i[t];if(0!==a)if(a)e.push(a[2]);else{var r=new Promise(function(e,n){a=i[t]=[e,n]});e.push(a[2]=r);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=o(t),l=function(e){d.onerror=d.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+a+": "+s+")");r.type=a,r.request=s,n[1](r)}i[t]=void 0}};var u=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(e)},c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var m=d;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("96cf");var a=n("3b8d"),s=(n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t.is_login?n("el-container",{staticClass:"container"},[n("el-header",{staticStyle:{height:"0px"}}),n("el-main",{staticClass:"body"},[n("router-view")],1),n("el-footer",{staticClass:"footer"},[n("span",[n("router-link",{staticClass:"el-icon-chat-line-round",attrs:{to:"/"}},[t._v(" 表态")])],1),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[n("router-link",{staticClass:"el-icon-smoking",attrs:{to:"/smoking"}},[t._v(" 吸烟区")])],1),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[n("router-link",{staticClass:"el-icon-mobile-phone",attrs:{to:"/me"}},[t._v(" 自己")])],1)],1)],1):n("router-view")],1)},r=[],o={name:"app",components:{},mounted:function(){this.$checkUser(),this.$router.push("/login")},computed:{is_login:function(){var t=this.$store.state.user.id;return!!t}}},c=o,l=(n("034f"),n("2877")),d=Object(l["a"])(c,i,r,!1,null,null,null),u=d.exports,m=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.screenLoading,expression:"screenLoading"}],staticClass:"home"},[n("el-card",{staticClass:"box-card first-card"},[n("el-col",{attrs:{span:20}},[n("div",{staticClass:"notice-title"},[t._v("话题")]),n("div",{staticClass:"notice-content"},[t._v("本期主题：你为什么睡不着")])]),n("el-col",{staticClass:"first-card-col-right",attrs:{span:4}},[n("el-button",{attrs:{icon:"el-icon-edit",type:"primary",circle:""},on:{click:function(e){t.send.display=!0}}})],1)],1),t._l(t.list,function(e){return n("el-card",{staticClass:"box-card"},[n("div",{on:{click:function(n){return t.showDetail(e)}}},[t._v("\n        "+t._s(e.content)+"\n      ")]),n("p",{staticClass:"time",on:{click:function(n){return t.showDetail(e)}}},[t._v("\n        "+t._s(e.name)+" 于 "+t._s(t.formatTime(e.create_at))+" 发送\n        "),n("br"),n("span",{staticClass:"el-icon-chat-dot-round"},[t._v(t._s(e.c_count?e.c_count:0))]),n("el-divider",{attrs:{direction:"vertical"}}),n("span",{staticClass:"el-icon-sunny"},[t._v(t._s(e.star?e.star:0))]),n("el-divider",{attrs:{direction:"vertical"}}),n("span",{staticClass:"el-icon-heavy-rain"},[t._v(t._s(e.shit?e.shit:0))])],1)])}),n("el-card",{directives:[{name:"show",rawName:"v-show",value:!t.nomore,expression:"!nomore"}],staticClass:"box-card",staticStyle:{"text-align":"center","font-size":"13px",padding:"0"}},[n("span",{on:{click:t.nextPage}},[t._v("\n\t\t\t\t下一页\n\t\t\t")])]),n("el-card",{directives:[{name:"show",rawName:"v-show",value:t.nomore,expression:"nomore"}],staticClass:"box-card",staticStyle:{"text-align":"center","font-size":"13px",padding:"0"}},[n("span",{on:{click:t.reload}},[t._v("\n\t\t\t\t没有更多了，点击重新加载\n\t\t\t")])]),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.send.loading,expression:"send.loading"}],attrs:{title:"想要表态",visible:t.send.display,width:"100%"},on:{"update:visible":function(e){return t.$set(t.send,"display",e)}}},[n("el-form",[n("el-form-item",{attrs:{"label-width":"0"}},[n("el-input",{attrs:{rows:10,type:"textarea",placeholder:"请输入内容",autosize:{minRows:3,maxRows:10}},model:{value:t.send.data.content,callback:function(e){t.$set(t.send.data,"content",e)},expression:"send.data.content"}}),t.sendTotalCount>30?n("span",{staticStyle:{color:"red"}},[t._v("\n            剩余字数 "+t._s(t.sendTotalCount)+" / 30\n          ")]):n("span",[t._v("\n            剩余字数 "+t._s(t.sendTotalCount)+" / 30\n          ")])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",disabled:t.sendTotalCount>30},on:{click:t.sendMoment}},[t._v("表态！")])],1)],1),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.detail.loading,expression:"detail.loading"}],attrs:{visible:t.detail.display,fullscreen:!0},on:{"update:visible":function(e){return t.$set(t.detail,"display",e)}}},[n("h3",[n("i",{staticClass:"el-icon-sugar",staticStyle:{"font-size":"20px"}}),t._v(" "+t._s(t.detail.data.name)+" 说：")]),n("span",{staticClass:"detail-content"},[t._v(t._s(t.detail.data.content))]),n("p",{staticClass:"time",staticStyle:{"margin-bottom":"30px"}},[t._v(t._s(t.detail.data.create_at))]),n("div",{staticClass:"block"},[n("el-slider",{attrs:{"show-tooltip":!1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t.hasComments?n("el-divider",{staticClass:"others-say-divider"},[t._v("其他人说")]):n("el-divider",{staticClass:"others-say-divider"},[t._v("其他人啥都没说")]),n("el-card",{staticClass:"detail-box-card"},[n("div",{staticClass:"text item",staticStyle:{"text-align":"center"}},[t.hasComments?n("span",{staticClass:"el-icon-thumb"},[t._v(" 加入 「其他人」")]):n("span",{staticClass:"el-icon-thumb"},[t._v(" 我先说点啥")])])]),t._l(t.detail.data.comments,function(e){return n("el-card",{directives:[{name:"show",rawName:"v-show",value:t.hasComments,expression:"hasComments"}],staticClass:"detail-box-card"},[n("span",[t._v(t._s(e.name)+" :")]),n("div",{staticClass:"text item"},[t._v("\n          "+t._s(e.content)+"\n        ")])])}),t.hasComments?n("el-divider",{staticClass:"others-say-divider"},[t._v("其他人说完了")]):t._e()],2)],2)},f=[],h={name:"home",components:{},data:function(){return{screenLoading:!1,list:[],page:1,nomore:!1,send:{loading:!1,display:!1,data:{content:""}},detail:{loading:!1,display:!1,data:{comments:[]}}}},mounted:function(){this.$checkUser(),this.getMomentList()},methods:{getMomentList:function(t){var e,n=this;e=t?this.page+1:this.page,this.screenLoading=!0,this.$utils.ajax("listMoment",{page:e}).then(function(e){if(n.screenLoading=!1,200==e.data.code){var a=e.data.data;for(var s in a)n.list.push(a[s]);t&&n.page++}else"没有更多数据了"==e.data.msg?(n.$message({type:"error",message:e.data.msg}),n.nomore=!0):n.$message({type:"error",message:e.data.msg})})},formatTime:function(t){return this.$utils.formatTime(t)},nextPage:function(){this.getMomentList(!0)},reload:function(){this.list=[],this.page=1,this.nomore=!1,this.getMomentList()},sendMoment:function(){var t=this;this.screenLoading=!0,this.$utils.ajax("sendMoment",{userid:this.$store.state.user.id,content:this.send.data.content}).then(function(e){t.screenLoading=!1,t.send.data.content="",t.send.display=!1,t.reload()})},showDetail:function(t){var e=this;this.screenLoading=!0,this.$utils.ajax("momentDetail",{mid:t.id}).then(function(t){e.screenLoading=!1,200===t.data.code?(e.detail.display=!0,e.detail.data=t.data.data,console.log(e.detail.data)):e.$message({type:"error",message:t.data.msg})})}},computed:{sendTotalCount:function(){return this.send.data.content.length},hasComments:function(){return this.detail.data.comments.length>0}}},v=h,g=(n("cccb"),Object(l["a"])(v,p,f,!1,null,null,null)),y=g.exports;s["default"].use(m["a"]);var _=new m["a"]({routes:[{path:"/",name:"home",meta:"表态",component:y},{path:"/smoking",name:"smoking",meta:"吸烟区",component:function(){return n.e("chunk-45775c53").then(n.bind(null,"1a21"))}},{path:"/me",name:"me",meta:"自己",component:function(){return n.e("chunk-f73e891c").then(n.bind(null,"0a99"))}},{path:"/login",name:"login",meta:"登录",component:function(){return n.e("chunk-04190fae").then(n.bind(null,"a55b"))}}]}),b=n("2f62");s["default"].use(b["a"]);var C=new b["a"].Store({state:{user:{id:"",name:""}},mutations:{},actions:{}}),x=n("5c96"),w=n.n(x);n("c69f");s["default"].use(w.a);var k=n("2427"),$=n.n(k),j="http://nightapi.xtzero.me/index.php/";function S(t,e){var n=[];for(var a in e)n.push(a+"="+e[a]);var s=j+t+"?"+n.join("&");return $.a.get(s)}function T(t,e){return parseInt(Math.random()*(e-t+1)+t,10)}function L(t,e){var n=new Date(t).getTime()/1e3,a=new Date(1e3*n),s=a.getFullYear(),i=a.getMonth()+1,r=a.getDate(),o=a.getHours(),c=a.getMinutes();if(1==e)return c>=0&&c<=9&&(c="0"+c),s+"-"+i+"-"+r+" "+o+":"+c;var l=new Date;return s==l.getFullYear()?s="":s==l.getFullYear()-1?s="去年 ":s+="年",i==l.getMonth()+1?i="":i+="月",r==l.getDate()?r="今天 ":r==l.getDate()-1?r="昨天":(""==i&&(i="本月 "),r+="号 "),o<10&&(o="0"+o),c<10&&(c="0"+c),s+i+r+o+":"+c}s["default"].config.productionTip=!1;var M={ajax:S,rand:T,formatTime:L};s["default"].prototype.$utils=M,s["default"].prototype.$checkUser=function(){var t=this,e=localStorage.getItem("userid.night.xtzero.me"),n=localStorage.getItem("name.night.xtzero.me");e?(this.$store.state.user.id=e,this.$store.state.user.name=n,M.ajax("checkUser",{userid:e}).then(function(e){200!=e.data.code&&t.$router.push("/login")}).catch(function(t){s["default"].prototype.$message({type:"error",message:"检查用户时出现错误"})})):this.$router.push("/login")},new s["default"]({router:_,store:C,render:function(t){return t(u)}}).$mount("#app"),_.beforeEach(function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e,n,a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:document.title=e.meta,a();case 2:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}())},"64a9":function(t,e,n){},c69f:function(t,e,n){},cccb:function(t,e,n){"use strict";var a=n("d563"),s=n.n(a);s.a},d563:function(t,e,n){}});
//# sourceMappingURL=app.4118e047.js.map